# /speckit.tasks 指令最佳实践

## 指令概述

`/speckit.tasks` 将开发计划进一步细化为具体的可执行任务清单，包含详细的任务描述、验收标准和执行步骤。

## 基本用法

### 直接使用（常见方式）
```
@github/copilot /speckit.tasks
```
**实际效果**：
- 基于当前的开发计划或规范文档生成任务清单
- 自动识别任务优先级和依赖关系
- 生成可直接用于项目管理的任务列表

### 带描述使用
```
@github/copilot /speckit.tasks [具体模块或阶段的任务分解]
```

## 使用场景

- 将开发计划分解为具体执行任务
- 创建 Sprint 任务清单
- 生成可跟踪的开发检查点
- 明确任务验收标准和定义完成条件

## 实际使用场景

### 基于开发计划生成任务

**操作步骤**：
1. 在开发计划文档中使用 `/speckit.tasks`
2. Copilot 自动分析计划内容
3. 生成详细的任务分解

### 针对特定功能模块

在功能规范文件中使用，获得该功能的具体实现任务。

## 最佳实践

### 1. 基于计划文档生成任务

直接在开发计划文档中使用，获得完整的任务分解：
- 自动识别开发阶段
- 生成具体的可执行任务
- 包含时间估算和优先级

### 2. 针对特定 Sprint 生成任务

为即将开始的开发冲刺生成详细任务清单。

## 真实案例示例

### 案例 1：用户认证系统任务分解

**输入**：直接在用户认证开发计划中执行 `/speckit.tasks`

**输出示例**：
```markdown
# 用户认证系统开发任务清单

## Sprint 1: 基础架构搭建 (Week 1)

### 后端任务 - 工程师A

#### T001: 数据库设计和搭建
**优先级**: P0 (阻塞)  
**预估**: 1天  
**依赖**: 无

**任务描述**:
- 设计用户表结构 (users, user_sessions, user_profiles)
- 创建数据库迁移脚本
- 配置数据库连接和连接池
- 设置索引和约束

**验收标准**:
- [ ] 数据库表创建成功
- [ ] 所有字段和约束正确设置
- [ ] 索引创建完成 (email, phone)
- [ ] 连接池配置正常工作
- [ ] 迁移脚本可重复执行

**测试步骤**:
```sql
-- 验证表结构
DESCRIBE users;
-- 验证索引
SHOW INDEX FROM users;
-- 验证约束
INSERT INTO users (email) VALUES ('test@example.com');
```

#### T002: 用户模型和基础API
**优先级**: P0  
**预估**: 1.5天  
**依赖**: T001

**任务描述**:
- 创建 User 数据模型 (Prisma/Sequelize)
- 实现基础 CRUD 操作
- 设计 API 路由结构
- 实现基础错误处理

**验收标准**:
- [ ] User 模型定义完成
- [ ] 基础 API 端点实现 (GET, POST, PUT, DELETE)
- [ ] 输入验证中间件
- [ ] 统一错误响应格式
- [ ] API 文档生成

**API 端点**:
```
GET    /api/users/:id     - 获取用户信息
POST   /api/users         - 创建用户
PUT    /api/users/:id     - 更新用户信息
DELETE /api/users/:id     - 删除用户
```

#### T003: JWT认证中间件
**优先级**: P0  
**预估**: 1天  
**依赖**: T002

**任务描述**:
- 实现 JWT token 生成和验证
- 创建认证中间件
- 配置 token 过期策略
- 实现 refresh token 机制

**验收标准**:
- [ ] JWT 签名和验证正常
- [ ] 中间件正确拦截未认证请求
- [ ] Token 过期时间配置 (1小时)
- [ ] Refresh token 实现 (30天)
- [ ] 安全头部设置

### 前端任务 - 工程师B

#### T004: 项目初始化和路由
**优先级**: P0  
**预估**: 0.5天  
**依赖**: 无

**任务描述**:
- 创建 React 项目脚手架
- 配置 TypeScript 和 ESLint
- 设置路由结构 (React Router)
- 配置开发环境

**验收标准**:
- [ ] 项目启动正常 (npm start)
- [ ] TypeScript 配置正确
- [ ] 路由配置完成 (/login, /register, /dashboard)
- [ ] 代码规范检查通过
- [ ] 热重载功能正常

#### T005: 登录注册页面UI
**优先级**: P1  
**预估**: 2天  
**依赖**: T004

**任务描述**:
- 实现登录页面布局和样式
- 实现注册页面布局和样式
- 添加表单输入组件
- 实现响应式设计

**验收标准**:
- [ ] 登录页面UI完成
- [ ] 注册页面UI完成
- [ ] 移动端适配正常
- [ ] 表单组件可复用
- [ ] 符合设计规范

**组件清单**:
- LoginForm 组件
- RegisterForm 组件
- InputField 组件
- Button 组件
- Logo 组件

## Sprint 2: 核心功能开发 (Week 2)

### T006: 用户注册API实现
**优先级**: P0  
**预估**: 1.5天  
**依赖**: T003

**任务描述**:
- 实现用户注册逻辑
- 密码加密存储 (bcrypt)
- 邮箱验证机制
- 重复注册检查

**验收标准**:
- [ ] 注册API正常工作
- [ ] 密码正确加密存储
- [ ] 邮箱验证邮件发送
- [ ] 重复邮箱注册拒绝
- [ ] 输入格式验证

**API测试**:
```bash
curl -X POST /api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "SecurePass123!",
    "firstName": "张",
    "lastName": "三"
  }'
```

### T007: 登录API和token管理
**优先级**: P0  
**预估**: 1天  
**依赖**: T006

**任务描述**:
- 实现登录验证逻辑
- JWT token 生成和返回
- 登录失败计数和锁定
- 登录日志记录

**验收标准**:
- [ ] 登录验证正确
- [ ] Token 正确生成和返回
- [ ] 失败3次账户锁定
- [ ] 登录日志完整记录
- [ ] 错误消息用户友好

### T008: 前端登录注册表单
**优先级**: P1  
**预估**: 2天  
**依赖**: T005, T007

**任务描述**:
- 实现表单提交逻辑
- API 请求集成
- 表单验证实现
- 错误处理和提示

**验收标准**:
- [ ] 表单提交正常工作
- [ ] 实时表单验证
- [ ] 错误信息正确显示
- [ ] 成功后页面跳转
- [ ] 加载状态显示

## 任务管理建议

### 任务优先级定义
- **P0**: 阻塞任务，必须完成
- **P1**: 重要任务，影响核心功能
- **P2**: 一般任务，可适当延后
- **P3**: 优化任务，时间充裕时完成

### 任务状态跟踪
- **Todo**: 待开始
- **In Progress**: 进行中
- **Code Review**: 代码审查
- **Testing**: 测试阶段
- **Done**: 已完成

### 每日站会检查点
- 昨天完成的任务
- 今天计划的任务
- 遇到的阻塞问题
- 需要的帮助或协作
```

### 案例 2：电商商品模块任务分解

**输入**：在商品功能规范中执行 `/speckit.tasks`

**输出示例**：
```markdown
# 商品管理模块任务清单

## 数据层任务

### T101: 商品数据模型设计
**负责人**: 后端工程师A  
**预估**: 1天  
**优先级**: P0

**任务详情**:
- 设计商品表结构 (products, categories, product_images)
- 定义商品属性和规格表
- 设计库存管理表
- 创建数据库索引策略

**验收标准**:
- [ ] ER图设计完成
- [ ] 数据库迁移脚本
- [ ] 索引优化策略
- [ ] 数据完整性约束

### T102: 商品CRUD API
**负责人**: 后端工程师A  
**预估**: 2天  
**依赖**: T101

**子任务**:
- T102.1: 商品创建API (0.5天)
- T102.2: 商品查询API (0.5天)
- T102.3: 商品更新API (0.5天)
- T102.4: 商品删除API (软删除) (0.5天)

**验收标准**:
- [ ] 所有CRUD操作正常
- [ ] API文档完整
- [ ] 输入验证完整
- [ ] 权限控制正确

## 搜索功能任务

### T103: 商品搜索实现
**负责人**: 后端工程师B  
**预估**: 3天  
**依赖**: T102

**技术方案**:
- 使用 Elasticsearch 作为搜索引擎
- 实现搜索结果相关性排序
- 支持多字段搜索和筛选

**子任务**:
- T103.1: Elasticsearch 集成 (1天)
- T103.2: 搜索索引设计 (0.5天)
- T103.3: 搜索API实现 (1天)
- T103.4: 搜索结果排序 (0.5天)

**验收标准**:
- [ ] 关键词搜索准确
- [ ] 筛选功能正常
- [ ] 搜索性能 < 200ms
- [ ] 分页功能完整

## 前端展示任务

### T104: 商品列表页面
**负责人**: 前端工程师A  
**预估**: 2天  
**依赖**: T103

**功能要求**:
- 商品卡片式展示
- 筛选和排序功能
- 无限滚动加载
- 响应式设计

**验收标准**:
- [ ] 商品列表正确显示
- [ ] 筛选功能正常工作
- [ ] 加载性能良好
- [ ] 移动端适配完成

### T105: 商品详情页面
**负责人**: 前端工程师A  
**预估**: 2天  
**依赖**: T104

**功能要求**:
- 商品图片轮播
- 商品信息详细展示
- 规格选择功能
- 加入购物车按钮

**验收标准**:
- [ ] 页面布局美观
- [ ] 图片加载优化
- [ ] 规格选择逻辑
- [ ] 购物车集成

## 管理后台任务

### T106: 商品管理界面
**负责人**: 前端工程师B  
**预估**: 3天  
**依赖**: T102

**功能模块**:
- 商品列表管理
- 商品编辑表单
- 图片上传功能
- 批量操作功能

**验收标准**:
- [ ] 管理界面完整
- [ ] 表单验证正确
- [ ] 图片上传正常
- [ ] 批量操作可用

## 测试任务

### T107: 单元测试编写
**负责人**: 全体开发人员  
**预估**: 2天  
**依赖**: T102, T103

**测试覆盖**:
- API接口测试
- 业务逻辑测试
- 前端组件测试
- 集成测试

**验收标准**:
- [ ] 测试覆盖率 > 85%
- [ ] 所有测试用例通过
- [ ] 性能测试通过
- [ ] 安全测试通过
```

## 输出格式说明

tasks 指令生成的核心要素：

1. **任务编号** - 唯一标识和追踪
2. **任务描述** - 清晰的工作内容
3. **验收标准** - 明确的完成定义
4. **时间估算** - 工作量预估
5. **依赖关系** - 任务间的先后顺序
6. **负责人** - 明确的责任分工

## 使用技巧

1. **任务粒度适中** - 单个任务 0.5-2天完成
2. **验收标准具体** - 可测试、可验证的标准
3. **依赖关系清晰** - 识别任务间的阻塞关系
4. **优先级明确** - P0-P3 优先级分级
5. **可跟踪性** - 每个任务都有明确的状态

## 与其他指令配合

- 基于 `/speckit.plan` 的开发计划生成任务
- 使用 `/speckit.implement` 执行具体任务
- 用 `/speckit.clarify` 澄清任务细节
- 结合项目管理工具进行任务跟踪